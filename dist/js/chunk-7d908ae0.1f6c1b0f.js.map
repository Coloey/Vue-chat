{"version":3,"sources":["webpack:///./src/components/contact/contact-dialogue.vue","webpack:///./src/components/contact/contact-dialogue.vue?3116","webpack:///./node_modules/core-js/modules/es.date.to-string.js","webpack:///./src/client.js","webpack:///./src/components/contact/contact-dialogue.vue?ecff"],"names":["id","class","$router","back","pageName","msgArr","item","index","key","text","src","$store","state","userInfo","avatar","toUser","$route","query","currentChatWay","type","InpVal","focusIpt","blurIpt","style","submit","name","beforeRouteEnter","to","from","next","vm","commit","setup","route","store","timer","date","Date","toLocaleString","obj","value","lastMsg","setInterval","document","body","scrollTop","scrollHeight","clearInterval","directives","more","mounted","element","startTx","startTy","addEventListener","e","msgMore","getElementById","touches","clientX","clientY","clearTimeout","this","setTimeout","left","top","offsetTop","display","backgroundColor","changedTouches","disY","Math","abs","press","recording","querySelector","recordingVoice","recordingCancel","className","preventDefault","endTy","distanceY","__exports__","render","uncurryThis","redefine","DatePrototype","prototype","INVALID_DATE","TO_STRING","un$DateToString","getTime","String","NaN","CHAT","push"],"mappings":"4IAEYA,GAAG,a,GACJC,MAAM,U,EAEP,gCAAe,YAAT,MAAE,G,GAAR,G,GAKDA,MAAM,6B,GAOJA,MAAM,Q,GACJA,MAAM,U,YAEb,gCAMO,QANDA,MAAM,WAAWD,GAAG,Y,CACxB,gCAIK,WAHH,gCAAW,UAAP,MACJ,gCAAW,UAAP,MACJ,gCAAW,UAAP,U,MAIFC,MAAM,mB,GACPA,MAAM,iC,GAaJA,MAAM,Y,GACJA,MAAM,Y,EACT,gCAA8B,QAAxBA,MAAM,OAAM,SAAK,G,EACvB,gCAA8B,QAAxBA,MAAM,OAAM,SAAK,G,GADvB,EACA,G,GAGCA,MAAM,Y,EASX,gCAA6D,QAAvDA,MAAM,2CAAyC,S,gpBAxD3D,gCA6FM,YA5FJ,gCAOS,SAPT,EAOS,CANP,gCAKM,MALN,EAKM,CAJJ,gCAEM,OAFDA,MAAM,6BAA8B,QAAK,+BAAE,EAAAC,QAAQC,U,GAGxD,gCAA2B,yCAAlB,EAAAC,UAAQ,OAGrB,gCAiBM,MAjBN,EAiBM,E,2BAhBH,gCAQI,2CANqB,EAAAC,QAAM,SAAtBC,EAAMC,G,6DAFf,gCAQI,MAPHN,MAAM,gBAELO,IAAKD,G,uDAGN,gCAA2C,IAA3C,EAA2C,C,0DAAhBD,EAAKG,MAAI,M,OACpC,gCAAsE,MAAtE,EAAsE,CAAlD,gCAA4C,OAAtCC,IAAK,EAAAC,OAAOC,MAAMC,SAASC,Q,4BAH7CR,EAAKS,QAAQ,EAAAC,OAAOC,MAAMjB,S,MAKpC,IAQF,gCAiES,SAjET,EAiES,CAhEP,gCA+DM,MA/DN,EA+DM,C,4BA9DJ,gCAKO,QAJLC,MAAM,iCAEL,QAAK,+BAAE,EAAAiB,gBAAc,K,wBADb,EAAAA,kB,4BAIX,gCAKO,QAJLjB,MAAM,+BAEL,QAAK,+BAAE,EAAAiB,gBAAc,K,uBADd,EAAAA,kB,4BAIV,gCAKM,MALN,EAKM,C,sDAJJ,gCAGM,MAHN,EAGM,K,0BAJuB,EAAAA,kB,4BAM/B,gCAQM,MARN,EAQM,C,4BAPJ,gCAME,SALAC,KAAK,O,qDACI,EAAAC,OAAM,IACfnB,MAAM,WACL,QAAK,8BAAE,EAAAoB,UAAA,EAAAA,SAAA,qBACP,OAAI,8BAAE,EAAAC,SAAA,EAAAA,QAAA,sB,4BAHE,EAAAF,W,kBAHiB,EAAAF,kBAS9B,EACA,gCAMyB,QANnBjB,MAAM,gBACZsB,MAAA,gGAKC,QAAK,8BAAE,EAAAC,QAAA,EAAAA,OAAA,sBAAQ,MAChB,Q,sEAsCO,GACbC,KAAM,mBACNC,iBAFa,SAEIC,EAAIC,EAAMC,GACzBA,GAAK,SAACC,GACJA,EAAGnB,OAAOoB,OAAO,cAAeD,EAAGd,OAAOC,MAAMQ,UAGpDO,MAPa,WAQX,IAAMC,EAAQ,iBACRC,EAAM,iBACR9B,EAAW,iBAAI6B,EAAMhB,MAAMQ,MAC3BP,EAAiB,kBAAI,GACrBiB,EAAQ,iBAAI,MACZf,EAAO,iBAAI,IACXf,EAAO,iBAAI,OAAKA,QACdmB,EAAO,WACX,IAAIY,GAAK,IAAIC,MAAOC,iBACdC,EAAI,CACRH,KAAKA,EACL3B,KAAKW,EAAOoB,MACZzB,OAAOkB,EAAMhB,MAAMjB,IAEdyC,EAAQ,CACZL,KAAKA,EACL3B,KAAKW,EAAOoB,OAETxC,EAAGiC,EAAMhB,MAAMjB,GACrBkC,EAAMH,OAAO,gBAAgB,CAACU,UAAQzC,OACtCoB,EAAOoB,MAAM,GACb,OAAKhB,OAAOe,GACZlC,EAAOmC,MAAM,OAAKnC,QAMdgB,EAAS,WACXc,EAAMO,aAAY,WACdC,SAASC,KAAKC,UAAUF,SAASC,KAAKE,eACxC,MAEAxB,EAAQ,WACVyB,cAAcZ,IAElB,MAAO,CACH/B,WACAc,iBACAG,WACAC,UACAjB,SACAmB,SACAJ,WAGN4B,WAAW,CACRC,KAAM,CACLC,QADK,SACGC,GACN,IAAIC,EAASC,EACbF,EAAQG,iBACN,cACA,SAAUC,GACR,IAAIC,EAAUb,SAASc,eAAe,YACpCC,EAAUH,EAAEG,QAAQ,GACtBN,EAAUM,EAAQC,QAClBN,EAAUK,EAAQE,QAClBC,aAAaC,KAAK3B,OAClB2B,KAAK3B,MAAQ4B,YAAW,WAEtBP,EAAQjC,MAAMyC,MACXZ,EAAU,GAAK,IAAM,IAAMA,EAAU,IAAM,KAC9CI,EAAQjC,MAAM0C,IAAMd,EAAQe,UAAY,GAAK,KAC7CV,EAAQjC,MAAM4C,QAAU,QACxBhB,EAAQ5B,MAAM6C,gBAAkB,YAC/B,QAEL,GAEFjB,EAAQG,iBACN,aACA,SAAUC,GACR,IAAIG,EAAUH,EAAEc,eAAe,GAC7BC,EAAOZ,EAAQE,QACbW,KAAKC,IAAIF,EAAOjB,GAAW,IAC7BQ,aAAaC,KAAK3B,UAGtB,GAEFgB,EAAQG,iBACN,YACA,WACEO,aAAaC,KAAK3B,UAEpB,KAIJsC,MAAM,CACFvB,QADE,SACMC,GACJ,IAGIE,EAHAqB,EAAU/B,SAASgC,cAAc,cACjCC,EAAejC,SAASgC,cAAc,oBACtCE,EAAgBlC,SAASgC,cAAc,qBAE3CxB,EAAQG,iBAAiB,cAAa,SAASC,GAC3CJ,EAAQ2B,UAAU,sBAClBJ,EAAUnD,MAAM4C,QAAQS,EAAerD,MAAM4C,QAAQ,QACrD,IAAIT,EAAQH,EAAEG,QAAQ,GACtBL,EAAQK,EAAQE,QAChBL,EAAEwB,oBAEJ,GACF5B,EAAQG,iBAAiB,YAAW,SAASC,GACzCJ,EAAQ2B,UAAU,WAClBD,EAAgBtD,MAAM4C,QAAQO,EAAUnD,MAAM4C,QAC9CS,EAAerD,MAAM4C,QAAQ,OAC7BZ,EAAEwB,oBACN,GACF5B,EAAQG,iBAAiB,aAAY,SAASC,GAC1C,IAAIG,EAAQH,EAAEc,eAAe,GAC7BW,EAAMtB,EAAQE,QACdqB,EAAU5B,EAAQ2B,EACfC,EAAU,IACT9B,EAAQ2B,UAAU,WAClBF,EAAerD,MAAM4C,QAAQ,OAC7BU,EAAgBtD,MAAM4C,QAAQ,UAG9BhB,EAAQ2B,UAAU,sBAClBF,EAAerD,MAAM4C,QAAQ,QAC7BU,EAAgBtD,MAAM4C,QAAQ,QAElCZ,EAAEwB,oBACJ,O,iCCpOd,MAAMG,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD,gB,uBCTf,IAAIC,EAAc,EAAQ,QACtBC,EAAW,EAAQ,QAEnBC,EAAgBjD,KAAKkD,UACrBC,EAAe,eACfC,EAAY,WACZC,EAAkBN,EAAYE,EAAcG,IAC5CE,EAAUP,EAAYE,EAAcK,SAIpCC,OAAO,IAAIvD,KAAKwD,OAASL,GAC3BH,EAASC,EAAeG,GAAW,WACjC,IAAIjD,EAAQmD,EAAQ7B,MAEpB,OAAOtB,IAAUA,EAAQkD,EAAgB5B,MAAQ0B,M,6DCTrD,IAAMM,EAAK,CACPzF,OAAO,GAKPmB,OAAO,SAASe,GAGZuD,EAAKzF,OAAO0F,KAAKxD,KAcVuD,U,oCC7Bf","file":"js/chunk-7d908ae0.1f6c1b0f.js","sourcesContent":["<template>\r\n  <div>\r\n    <header id=\"wx-header\">\r\n      <div class=\"center\">\r\n        <div class=\"iconfont icon-return-arrow\" @click=\"$router.back()\">\r\n          <span>返回</span>\r\n        </div>\r\n        <span>{{ pageName }}</span>\r\n      </div>\r\n    </header>\r\n    <div class=\"dialogue-section clearfix\">\r\n       <li \r\n        class=\"self clearfix\"\r\n        v-for=\"(item, index) in msgArr\"\r\n        :key=\"index\"\r\n        v-show=\"item.toUser==$route.query.id\"        \r\n      >\r\n        <p class=\"text\"  v-more>{{ item.text }}</p>\r\n        <div class=\"header\"><img :src=\"$store.state.userInfo.avatar\"  /></div>\r\n      </li>\r\n      <span class=\"msg-more\" id=\"msg-more\">\r\n        <ul>\r\n          <li>复制</li>\r\n          <li>转发</li>\r\n          <li>删除</li>\r\n        </ul>\r\n      </span>\r\n    </div>\r\n    <footer class=\"dialogue-footer\">\r\n      <div class=\"component-dialogue-bar-person\">\r\n        <span\r\n          class=\"iconfont icon-dialogue-jianpan\"\r\n          v-show=\"!currentChatWay\"\r\n          @click=\"currentChatWay = true\"\r\n        >\r\n        </span>\r\n        <span\r\n          class=\"iconfont icon-dialogue-voice\"\r\n          v-show=\"currentChatWay\"\r\n          @click=\"currentChatWay = false\"\r\n        >\r\n        </span>\r\n        <div class=\"chat-way\" v-show=\"!currentChatWay\">\r\n          <div class=\"chat-say\" v-press>\r\n            <span class=\"one\">按住 说话</span>\r\n            <span class=\"two\">松开 结束</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"chat-way\" v-show=\"currentChatWay\">\r\n          <input\r\n            type=\"text\"\r\n            v-model=\"InpVal\"\r\n            class=\"chat-txt\"\r\n            @focus=\"focusIpt\"\r\n            @blur=\"blurIpt\"\r\n          />\r\n        </div>\r\n        <span class=\"expression iconfont icon-dialogue-smile\"></span>\r\n        <span class=\"more iconfont\" \r\n        style=\"font-size: 15px;\r\n              background: #aa96da;\r\n              padding: 0px 5px;\r\n              border-radius: 12px;\r\n              color: #fff;\" \r\n        @click=\"submit\">发送</span>\r\n        <div class=\"recording\" style=\"display: none\" id=\"recording\">\r\n          <div\r\n            class=\"recording-voice\"\r\n            style=\"display: none\"\r\n            id=\"recording-voice\"\r\n          >\r\n            <div class=\"voice-inner\">\r\n              <div class=\"voice-icon\"></div>\r\n              <div class=\"voice-volume\">\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n              </div>\r\n            </div>\r\n            <p>手指上划，取消发送</p>\r\n          </div >\r\n          <div class=\"recording-cancel\" style=\"display:none\">\r\n              <div class=\"cancel-inner\"></div>\r\n              <p>松开手指，取消发送</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from \"vue-router\";\r\nimport {useStore} from \"vuex\";\r\nimport { ref } from \"vue\";\r\nimport CHAT from \"../../client\"\r\n\r\nexport default {\r\n  name: \"contact-dialogue\",\r\n  beforeRouteEnter(to, from, next) {\r\n    next((vm) => {\r\n      vm.$store.commit(\"setPageName\", vm.$route.query.name);\r\n    });\r\n  },\r\n  setup() {\r\n    const route = useRoute();\r\n    const store=useStore();\r\n    let pageName = ref(route.query.name);\r\n    let currentChatWay = ref(true); //true为键盘打字,false为语音输入\r\n    let timer = ref(null);\r\n    let InpVal=ref(\"\");\r\n    let msgArr=ref(CHAT.msgArr);\r\n    const submit=()=>{\r\n      var date=new Date().toLocaleString();         \r\n      const obj={\r\n        date:date,\r\n        text:InpVal.value,\r\n        toUser:route.query.id,\r\n      }\r\n       const lastMsg={\r\n         date:date,\r\n         text:InpVal.value,\r\n       }\r\n      const id=route.query.id\r\n      store.commit('changeLastMsg',{lastMsg,id});\r\n      InpVal.value=\"\";\r\n      CHAT.submit(obj)\r\n      msgArr.value=CHAT.msgArr;\r\n     // let msg=msgArr.value;\r\n      //console.log(msg)\r\n      //store.commit('addLatestContact',{id,msg});\r\n      //\r\n    };\r\n    const focusIpt=()=>{\r\n        timer=setInterval(function(){\r\n            document.body.scrollTop=document.body.scrollHeight;\r\n        },100);\r\n    }\r\n    const blurIpt=()=>{\r\n        clearInterval(timer);\r\n    }\r\n    return {\r\n        pageName,\r\n        currentChatWay,\r\n        focusIpt,\r\n        blurIpt,\r\n        msgArr,\r\n        submit,\r\n        InpVal\r\n    }\r\n  },\r\n  directives:{\r\n     more: {\r\n      mounted(element) {\r\n        var startTx, startTy;\r\n        element.addEventListener(\r\n          \"touchstart\",\r\n          function (e) {\r\n            var msgMore = document.getElementById(\"msg-more\"),\r\n              touches = e.touches[0];\r\n            startTx = touches.clientX;\r\n            startTy = touches.clientY;\r\n            clearTimeout(this.timer);\r\n            this.timer = setTimeout(() => {\r\n              // 控制菜单的位置\r\n              msgMore.style.left =\r\n                (startTx - 18 > 180 ? 180 : startTx - 18) + \"px\";\r\n              msgMore.style.top = element.offsetTop - 33 + \"px\";\r\n              msgMore.style.display = \"block\";\r\n              element.style.backgroundColor = \"#e5e5e5\";\r\n            }, 500);\r\n          },\r\n          false\r\n        );\r\n        element.addEventListener(\r\n          \"touchmove\",\r\n          function (e) {\r\n            var touches = e.changedTouches[0],\r\n              disY = touches.clientY;\r\n            if (Math.abs(disY - startTy) > 10) {\r\n              clearTimeout(this.timer);\r\n            }\r\n          },\r\n          false\r\n        );\r\n        element.addEventListener(\r\n          \"touchend\",\r\n          function () {\r\n            clearTimeout(this.timer);\r\n          },\r\n          false\r\n        );\r\n      },\r\n    },\r\n      press:{\r\n          mounted(element){\r\n              var recording=document.querySelector(\".recording\"),\r\n                  recordingVoice=document.querySelector(\".recording-voice\"),\r\n                  recordingCancel=document.querySelector(\".recording-cancel\"),\r\n                  startTy;\r\n              element.addEventListener(\"touchstart\",function(e){\r\n                  element.className=\"chat-say say-active\";\r\n                  recording.style.display=recordingVoice.style.display=\"block\"\r\n                  var touches=e.touches[0];\r\n                  startTy=touches.clientY;\r\n                  e.preventDefault();\r\n                  \r\n              },false);\r\n              element.addEventListener(\"touchend\",function(e){\r\n                  element.className=\"chat-say\";\r\n                  recordingCancel.style.display=recording.style.display=\r\n                  recordingVoice.style.display=\"none\";\r\n                  e.preventDefault();\r\n            },false);\r\n            element.addEventListener(\"touchmove\",function(e){\r\n                var touches=e.changedTouches[0],\r\n                endTy=touches.clientY,\r\n                distanceY=startTy-endTy;\r\n                if(distanceY>50){\r\n                    element.className=\"chat-say\";\r\n                    recordingVoice.style.display=\"none\";\r\n                    recordingCancel.style.display=\"block\"\r\n\r\n                }else{\r\n                    element.className=\"chat-say say-active\";\r\n                    recordingVoice.style.display=\"block\";\r\n                    recordingCancel.style.display=\"none\";\r\n                }\r\n                e.preventDefault();\r\n            },false)\r\n\r\n\r\n           }\r\n       }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\">\r\n@import \"../../assets/less/dialogue.less\";\r\n.say-active {\r\n    background: #c6c7ca;\r\n}\r\n</style>","import { render } from \"./contact-dialogue.vue?vue&type=template&id=2139208c\"\nimport script from \"./contact-dialogue.vue?vue&type=script&lang=js\"\nexport * from \"./contact-dialogue.vue?vue&type=script&lang=js\"\n\nimport \"./contact-dialogue.vue?vue&type=style&index=0&id=2139208c&lang=less\"\n\nimport exportComponent from \"D:\\\\Vue-chat\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","var uncurryThis = require('../internals/function-uncurry-this');\nvar redefine = require('../internals/redefine');\n\nvar DatePrototype = Date.prototype;\nvar INVALID_DATE = 'Invalid Date';\nvar TO_STRING = 'toString';\nvar un$DateToString = uncurryThis(DatePrototype[TO_STRING]);\nvar getTime = uncurryThis(DatePrototype.getTime);\n\n// `Date.prototype.toString` method\n// https://tc39.es/ecma262/#sec-date.prototype.tostring\nif (String(new Date(NaN)) != INVALID_DATE) {\n  redefine(DatePrototype, TO_STRING, function toString() {\n    var value = getTime(this);\n    // eslint-disable-next-line no-self-compare -- NaN check\n    return value === value ? un$DateToString(this) : INVALID_DATE;\n  });\n}\n","//import settings from \"./settings\"\r\n/*import {io} from \"socket.io-client\"\r\nvar socket=io();\r\nsocket.on(\"connect\",()=>{\r\n    console.log(socket.id)\r\n})*/\r\nconst CHAT={\r\n    msgArr:[],\r\n    \r\n    /*logout:function(){\r\n        socket.disconnect();\r\n    },*/\r\n    submit:function(obj){\r\n       // socket.emit('sendMsg',obj);//触发事件\r\n        \r\n        CHAT.msgArr.push(obj)\r\n    },\r\n   /* message:function(username){\r\n        this.socket.on('to'+username,function(obj){//事件被触发时调用的回调函数\r\n            \r\n        })\r\n    },*/\r\n    /* init:function(){\r\n         socket=io.connect(settings.socket,{'force new connection':true})\r\n         socket.on('open',function(){\r\n           console.log('已连接')\r\n         })\r\n     }*/\r\n}\r\nexport default CHAT","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./contact-dialogue.vue?vue&type=style&index=0&id=2139208c&lang=less\""],"sourceRoot":""}